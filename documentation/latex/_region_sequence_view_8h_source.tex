\doxysection{Region\+Sequence\+View.\+h}
\hypertarget{_region_sequence_view_8h_source}{}\label{_region_sequence_view_8h_source}\index{Source/UI/RegionSequenceView.h@{Source/UI/RegionSequenceView.h}}
\mbox{\hyperlink{_region_sequence_view_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}../Timeline/PlaybackRegion.h"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}../Util/TimeToViewScaling.h"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_region_sequence_view}{RegionSequenceView}}\ :\ \textcolor{keyword}{public}\ Component,}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ ChangeBroadcaster,}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_time_to_view_scaling_1_1_listener}{TimeToViewScaling::Listener}},}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ ARARegionSequence::Listener,}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ ARAPlaybackRegion::Listener}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{class_region_sequence_view}{RegionSequenceView}}\ (ARAEditorView\&\ editorView,\ \mbox{\hyperlink{class_time_to_view_scaling}{TimeToViewScaling}}\&\ scaling,\ ARARegionSequence\&\ rs,\ \mbox{\hyperlink{struct_waveform_cache}{WaveformCache}}\&\ cache);}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{class_region_sequence_view}{\string~RegionSequenceView}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{void}\ willUpdateRegionSequenceProperties\ (ARARegionSequence*,\ ARARegionSequence::PropertiesPtr\ newProperties)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{void}\ willRemovePlaybackRegionFromRegionSequence\ (ARARegionSequence*,\ ARAPlaybackRegion*\ playbackRegion)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ didAddPlaybackRegionToRegionSequence\ (ARARegionSequence*,\ ARAPlaybackRegion*\ playbackRegion)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{void}\ willDestroyPlaybackRegion\ (ARAPlaybackRegion*\ playbackRegion)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{void}\ didUpdatePlaybackRegionProperties\ (ARAPlaybackRegion*)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ zoomLevelChanged\ (\textcolor{keywordtype}{double})\ \textcolor{keyword}{override};}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{void}\ resized()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{auto}\ getPlaybackDuration()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{\textcolor{keywordflow}{return}\ playbackDuration;\}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{void}\ createAndAddPlaybackRegionView\ (ARAPlaybackRegion*\ playbackRegion);}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{void}\ updatePlaybackDuration();}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ ARAEditorView\&\ araEditorView;}
\DoxyCodeLine{00052\ \ \ \ \ \mbox{\hyperlink{class_time_to_view_scaling}{TimeToViewScaling}}\&\ timeToViewScaling;}
\DoxyCodeLine{00053\ \ \ \ \ ARARegionSequence\&\ regionSequence;}
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{struct_waveform_cache}{WaveformCache}}\&\ waveformCache;}
\DoxyCodeLine{00055\ \ \ \ \ std::unordered\_map<ARAPlaybackRegion*,\ unique\_ptr<PlaybackRegionView>>\ playbackRegionViews;}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{double}\ playbackDuration\ =\ 0.0;}
\DoxyCodeLine{00057\ \};}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{comment}{//\ \#pragma\ once}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{//\ \#include\ "{}../Timeline/PlaybackRegion.h"{}}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{comment}{//\ class\ RegionSequenceView\ :\ public\ Component,}}
\DoxyCodeLine{00065\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ public\ ChangeBroadcaster,}}
\DoxyCodeLine{00066\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ private\ TimeToViewScaling::Listener,}}
\DoxyCodeLine{00067\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ private\ ARARegionSequence::Listener,}}
\DoxyCodeLine{00068\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ private\ ARAPlaybackRegion::Listener}}
\DoxyCodeLine{00069\ \textcolor{comment}{//\ \{}}
\DoxyCodeLine{00070\ \textcolor{comment}{//\ public:}}
\DoxyCodeLine{00071\ \textcolor{comment}{//\ \ \ \ \ RegionSequenceView\ (ARAEditorView\&\ editorView,\ TimeToViewScaling\&\ scaling,\ ARARegionSequence\&\ rs,\ WaveformCache\&\ cache)}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ :\ araEditorView\ (editorView),\ timeToViewScaling\ (scaling),\ regionSequence\ (rs),\ waveformCache\ (cache)}}
\DoxyCodeLine{00073\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00074\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ regionSequence.addListener\ (this);}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ for\ (auto*\ playbackRegion\ :\ regionSequence.getPlaybackRegions())}}
\DoxyCodeLine{00077\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ createAndAddPlaybackRegionView\ (playbackRegion);}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ updatePlaybackDuration();}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ timeToViewScaling.addListener\ (this);}}
\DoxyCodeLine{00082\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{comment}{//\ \ \ \ \ \string~RegionSequenceView()\ override}}
\DoxyCodeLine{00085\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00086\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ timeToViewScaling.removeListener\ (this);}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ regionSequence.removeListener\ (this);}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ for\ (const\ auto\&\ it\ :\ playbackRegionViews)}}
\DoxyCodeLine{00091\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ it.first-\/>removeListener\ (this);}}
\DoxyCodeLine{00092\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{comment}{//\ \ \ \ \ //==============================================================================}}
\DoxyCodeLine{00095\ \textcolor{comment}{//\ \ \ \ \ //\ ARA\ Document\ change\ callback\ overrides}}
\DoxyCodeLine{00096\ \textcolor{comment}{//\ \ \ \ \ void\ willUpdateRegionSequenceProperties\ (ARARegionSequence*,}}
\DoxyCodeLine{00097\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ARARegionSequence::PropertiesPtr\ newProperties)\ override}}
\DoxyCodeLine{00098\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00099\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ if\ (regionSequence.getColor()\ !=\ newProperties-\/>color)}}
\DoxyCodeLine{00100\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00101\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ for\ (auto\&\ pbr\ :\ playbackRegionViews)}}
\DoxyCodeLine{00102\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbr.second-\/>repaint();}}
\DoxyCodeLine{00103\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00104\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{comment}{//\ \ \ \ \ void\ willRemovePlaybackRegionFromRegionSequence\ (ARARegionSequence*,}}
\DoxyCodeLine{00107\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ARAPlaybackRegion*\ playbackRegion)\ override}}
\DoxyCodeLine{00108\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00109\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackRegion-\/>removeListener\ (this);}}
\DoxyCodeLine{00110\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ removeChildComponent\ (playbackRegionViews[playbackRegion].get());}}
\DoxyCodeLine{00111\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackRegionViews.erase\ (playbackRegion);}}
\DoxyCodeLine{00112\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ updatePlaybackDuration();}}
\DoxyCodeLine{00113\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{comment}{//\ \ \ \ \ void\ didAddPlaybackRegionToRegionSequence\ (ARARegionSequence*,\ ARAPlaybackRegion*\ playbackRegion)\ override}}
\DoxyCodeLine{00116\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00117\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ createAndAddPlaybackRegionView\ (playbackRegion);}}
\DoxyCodeLine{00118\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ updatePlaybackDuration();}}
\DoxyCodeLine{00119\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{comment}{//\ \ \ \ \ void\ willDestroyPlaybackRegion\ (ARAPlaybackRegion*\ playbackRegion)\ override}}
\DoxyCodeLine{00122\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00123\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackRegion-\/>removeListener\ (this);}}
\DoxyCodeLine{00124\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ removeChildComponent\ (playbackRegionViews[playbackRegion].get());}}
\DoxyCodeLine{00125\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackRegionViews.erase\ (playbackRegion);}}
\DoxyCodeLine{00126\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ updatePlaybackDuration();}}
\DoxyCodeLine{00127\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \textcolor{comment}{//\ \ \ \ \ void\ didUpdatePlaybackRegionProperties\ (ARAPlaybackRegion*)\ override}}
\DoxyCodeLine{00130\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00131\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ updatePlaybackDuration();}}
\DoxyCodeLine{00132\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \textcolor{comment}{//\ \ \ \ \ void\ zoomLevelChanged\ (double)\ override}}
\DoxyCodeLine{00135\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00136\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ resized();}}
\DoxyCodeLine{00137\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \textcolor{comment}{//\ \ \ \ \ void\ resized()\ override}}
\DoxyCodeLine{00140\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00141\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ for\ (auto\&\ pbr\ :\ playbackRegionViews)}}
\DoxyCodeLine{00142\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00143\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ const\ auto\ playbackRegion\ =\ pbr.first;}}
\DoxyCodeLine{00144\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ pbr.second-\/>setBounds\ (}}
\DoxyCodeLine{00145\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ getLocalBounds()}}
\DoxyCodeLine{00146\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .withTrimmedLeft\ (timeToViewScaling.getXForTime\ (playbackRegion-\/>getStartInPlaybackTime()))}}
\DoxyCodeLine{00147\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .withWidth\ (timeToViewScaling.getXForTime\ (playbackRegion-\/>getDurationInPlaybackTime())));}}
\DoxyCodeLine{00148\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00149\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \textcolor{comment}{//\ \ \ \ \ auto\ getPlaybackDuration()\ const\ noexcept}}
\DoxyCodeLine{00152\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ return\ playbackDuration;}}
\DoxyCodeLine{00154\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{comment}{//\ private:}}
\DoxyCodeLine{00157\ \textcolor{comment}{//\ \ \ \ \ void\ createAndAddPlaybackRegionView\ (ARAPlaybackRegion*\ playbackRegion)}}
\DoxyCodeLine{00158\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00159\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackRegionViews[playbackRegion]\ =\ std::make\_unique<PlaybackRegionView>\ (araEditorView,}}
\DoxyCodeLine{00160\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *playbackRegion,}}
\DoxyCodeLine{00161\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ waveformCache);}}
\DoxyCodeLine{00162\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackRegion-\/>addListener\ (this);}}
\DoxyCodeLine{00163\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ addAndMakeVisible\ (*playbackRegionViews[playbackRegion]);}}
\DoxyCodeLine{00164\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{comment}{//\ \ \ \ \ void\ updatePlaybackDuration()}}
\DoxyCodeLine{00167\ \textcolor{comment}{//\ \ \ \ \ \{}}
\DoxyCodeLine{00168\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ const\ auto\ iter\ =\ std::max\_element\ (}}
\DoxyCodeLine{00169\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ playbackRegionViews.begin(),}}
\DoxyCodeLine{00170\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ playbackRegionViews.end(),}}
\DoxyCodeLine{00171\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ []\ (const\ auto\&\ a,\ const\ auto\&\ b)\ \{\ return\ a.first-\/>getEndInPlaybackTime()\ <\ b.first-\/>getEndInPlaybackTime();\ \});}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ playbackDuration\ =\ iter\ !=\ playbackRegionViews.end()\ ?\ iter-\/>first-\/>getEndInPlaybackTime()}}
\DoxyCodeLine{00174\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 0.0;}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ sendChangeMessage();}}
\DoxyCodeLine{00177\ \textcolor{comment}{//\ \ \ \ \ \}}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \textcolor{comment}{//\ \ \ \ \ ARAEditorView\&\ araEditorView;}}
\DoxyCodeLine{00180\ \textcolor{comment}{//\ \ \ \ \ TimeToViewScaling\&\ timeToViewScaling;}}
\DoxyCodeLine{00181\ \textcolor{comment}{//\ \ \ \ \ ARARegionSequence\&\ regionSequence;}}
\DoxyCodeLine{00182\ \textcolor{comment}{//\ \ \ \ \ WaveformCache\&\ waveformCache;}}
\DoxyCodeLine{00183\ \textcolor{comment}{//\ \ \ \ \ std::unordered\_map<ARAPlaybackRegion*,\ unique\_ptr<PlaybackRegionView>>\ playbackRegionViews;}}
\DoxyCodeLine{00184\ \textcolor{comment}{//\ \ \ \ \ double\ playbackDuration\ =\ 0.0;}}
\DoxyCodeLine{00185\ \textcolor{comment}{//\ \};}}

\end{DoxyCode}
